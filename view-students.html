<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>View Students</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 1rem;
      background: #f2f2f2;
    }
    h1 {
      text-align: center;
    }
    .student-card {
      background: #fff;
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .student-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .student-details {
      margin-top: 0.5rem;
    }
    .pending {
      color: red;
      font-weight: bold;
    }
    .actions button {
      margin-right: 5px;
      padding: 5px 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .actions button.edit {
      background: #4CAF50;
      color: white;
    }
    .actions button.delete {
      background: #f44336;
      color: white;
    }
    .back-button {
      display: block;
      margin: 1rem auto;
      padding: 10px 20px;
      background: #2196F3;
      color: white;
      border: none;
      border-radius: 5px;
      text-align: center;
      text-decoration: none;
      font-weight: bold;
    }
    @media (max-width: 600px) {
      .student-header {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>

  <h1>ðŸ“‹ Student List</h1>
  <div id="studentsContainer"></div>
  <button class="back-button" onclick="window.location.href='home.html'">ðŸ”™ Back to Home</button>

  <script>
    const studentsContainer = document.getElementById("studentsContainer");
    const students = JSON.parse(localStorage.getItem("students") || "[]");

    function renderStudents() {
      studentsContainer.innerHTML = "";

      if (students.length === 0) {
        studentsContainer.innerHTML = "<p>No students found.</p>";
        return;
      }

      students.forEach((student, index) => {
        const card = document.createElement("div");
        card.className = "student-card";

        const header = document.createElement("div");
        header.className = "student-header";

        const namePhone = document.createElement("div");
        namePhone.innerHTML = `<strong>${student.name}</strong><br><small>${student.phone}</small>`;

        header.appendChild(namePhone);
        card.appendChild(header);

        const details = document.createElement("div");
        details.className = "student-details";
        details.innerHTML = `
          <div>Total Fee: â‚¹${student.totalFee || 0}</div>
          <div>Initial Payment: â‚¹${student.initialPayment || 0}</div>
          <div class="${student.pendingFee > 0 ? 'pending' : ''}">
            Pending Fee: â‚¹${student.pendingFee || 0}
          </div>
          <div>Days: ${student.days?.join(", ") || "N/A"}</div>
        `;
        card.appendChild(details);

        const actions = document.createElement("div");
        actions.className = "actions";

        const editBtn = document.createElement("button");
        editBtn.className = "edit";
        editBtn.textContent = "Edit";
        editBtn.onclick = () => editStudent(index);
        actions.appendChild(editBtn);

        const deleteBtn = document.createElement("button");
        deleteBtn.className = "delete";
        deleteBtn.textContent = "Delete";
        deleteBtn.onclick = () => deleteStudent(index);
        actions.appendChild(deleteBtn);

        card.appendChild(actions);
        studentsContainer.appendChild(card);
      });
    }

    function editStudent(index) {
      const student = students[index];
      const name = prompt("Edit name:", student.name);
      if (!name) return;
      const phone = prompt("Edit phone:", student.phone);
      if (!phone) return;
      const totalFee = parseFloat(prompt("Edit total fee:", student.totalFee || 0)) || 0;
      const initialPayment = parseFloat(prompt("Edit initial payment:", student.initialPayment || 0)) || 0;
      const pendingFee = totalFee - initialPayment;
      const days = prompt("Edit days (comma separated):", student.days?.join(",") || "").split(",").map(d => d.trim()).filter(Boolean);

      students[index] = {
        ...student,
        name,
        phone,
        totalFee,
        initialPayment,
        pendingFee,
        days
      };
      localStorage.setItem("students", JSON.stringify(students));
      renderStudents();
    }

    function deleteStudent(index) {
      if (confirm("Are you sure you want to delete this student?")) {
        students.splice(index, 1);
        localStorage.setItem("students", JSON.stringify(students));
        renderStudents();
      }
    }

    renderStudents();
  </script>
</body>
</html>
